











<img src="D:\Zhaoyong's Documents\图片\Njust.jpg" alt="Njust" style="zoom:55%;" />







# 基于 LMI 的控制系统分析与设计—2.3  基于扰动观测器的控制系统 LMI 控制

<div align = "center">Zhaoyong Liu, School of Automation, NJUST</div>

<div align = "center">December 19, 2023</div>













<div STYLE=“page-break-after: always;”></div

## 2.3.1  系统描述

考虑状态方程：
$$
\dot{x}=Ax+B(u+d)\tag{1}
$$

其中，$x=[x_1\ \  x_2]^T$ ，$u$ 为控制输入，$d$ 为状态扰动， $B=[0\ \  b]^T$ 。

扰动观测器设计为
$$
\left\{\begin{array}{l}
\dot{z}=-K_1[Ax+B(u+\hat{d})]\\
\hat{d}=z+K_1x
\end{array}
\right.\tag{2}
$$
定义扰动估计误差为 $\tilde{d}=d-\hat{d}$ ，则
$$
\dot{\tilde{d}}=\dot{d}-K_1B\tilde{d}
$$
控制器设计为
$$
u=Kx-\hat{d}\tag{3}
$$
其中，$K=[k_1\ \ k_2]$ 。

定义扩张状态向量为 $\xi=[x^T\ \ \tilde{d}^T]$​ ，则
$$
\dot{\xi}=\bar{A}\xi+\bar{B}\dot{d}
$$
其中，$\bar{A}=\begin{bmatrix}A+BK& B\\0&-K_1B\end{bmatrix},\bar{B}=\begin{bmatrix}0\\1\end{bmatrix}$ 。

我们的设计目标为通过求解 LMI 得到控制器增益 $K$ ，以及扰动观测器增益 $K_1$，从而实现 $x\rightarrow 0$ 。



## 2.3.2  控制器的设计与分析

设计 Lyapunov 函数如下：
$$
V=\xi^TP\xi\tag{4}
$$

其中，$P=\begin{bmatrix}P_1 & 0\\0& I\end{bmatrix},P_1>0,P_1=P_1^T$ 。

则我们有如下定理。

**[定理  1]**   给定参数 $\alpha>0,\sigma_1,\bar{D}>0$ ，以及系统矩阵 $A,B$ ，其中 $\bar{D}$ 满足 $|\dot{d}|\leq \bar{D}$ ，如果存在正定矩阵 $Q_1>0$，和适维矩阵 $R_1,K_1$ 使得下述线性矩阵不等式可解：
$$
\varPsi=\begin{bmatrix}
AQ_1+Q_1^TA^T+BR_1+R_1^TB^T+\alpha Q_1&B\\
*&-(K_1B+B^TK_1^T)+\sigma_1+\alpha
\end{bmatrix}<0\tag{5}
$$
则系统 $(1)$​ 满足
$$
V(t)\leq e^{-\alpha t}V(0)+\frac{1}{\sigma_1}\bar{D}^2\int_{0}^{t}e^{-\alpha \tau}\text{d}\tau.
$$
且 $P_1=Q_1^{-1}$ ，控制器增益为 $K=R_1Q_1^{-1}$ 。

> 注：由于 $B=[0\ \ b]^T$，因此 $K_1$ 的第一个元素可以任意取值，不妨取 $K_1=[0\ \ k]$ 。


## 2.3.3  仿真实例

考虑如下实际模型：
$$
\ddot{\theta}=-25\dot{\theta}+133[u(t)+d(t)]
$$
令 $x_1=\theta,x_2=\dot{\theta}$ ，则对应于系统 $(1)$ ，我们有 $A=\begin{bmatrix}0&1\\0&-25\end{bmatrix},B=\begin{bmatrix}0\\133\end{bmatrix}$ 。取 $d(t)=5\text{sin}(0.1t)$ ，初始状态为 $x(0)=[1\quad 0]^T$ 。

取 $\alpha=100,\sigma_1=10$，运行 LMI 求解程序 chap2_3LMI.m ，求解 LMI $(5)$ ，可得控制器增益为 $K=[0.9779\ \ 1.3371]$，扰动观测器增益为 $K_1=[]$，仿真结果如图-1 和图-2 所示。

<div>			
    <center>	
    <img src="D:\Typora\Documents\自动控制\基于LMI的控制系统分析与设计\Chap6_状态观测器设计\figure\chap6_1状态观测.jpg"
         alt="无法显示图片"
         width="80%"
         style="zoom:"/>
    <br>		
    图-1 &nbsp 状态观测结果	
    </center>
</div>

<div>			
    <center>	
    <img src="D:\Typora\Documents\自动控制\基于LMI的控制系统分析与设计\Chap6_状态观测器设计\figure\chap6_1状态观测误差.jpg"
         alt="无法显示图片"
         width="80%"
         style="zoom:"/>
    <br>		
    图-2 &nbsp 状态观测误差	
    </center>
</div>





仿真程序如下：

（1）求解 LMI 程序：chap2_3LMI.m

```
%%
clc; clearvars 
LMIs = 2;  % the number of LMIs
A = [0 1;0 -25]; 
B = [0 133]';
[dimn, dimm] = size(B);
alpha = 3;  % given parameters
sigma1 = 10;

%%
setlmis([]) 
q1 = lmivar(1,[dimn 1]); % define variable Q1
r1 = lmivar(2,[dimm dimn]); 
k = lmivar(1,[1 1]);
%%
lmiterm([1 1 1 q1],A,1,'s');  % LMI #1 
lmiterm([1 1 1 r1],B,1,'s');
lmiterm([1 1 1 q1],alpha,1);
lmiterm([1 1 2 0],B);
lmiterm([1 2 2 k],-[0 1],B,'s');
lmiterm([1 2 2 0],sigma1);
lmiterm([1 2 2 0],alpha);
%%
lmiterm([-2 1 1 q1],1,1);  % LMI #2

%% Solving LMIs
lmis = getlmis;
% [tmin,xfeas] = feasp(lmis,[0,0,10,0,0],0); % solving with function "feasp"
[tmin,xfeas] = feasp(lmis);
Q1 = dec2mat(lmis,xfeas,q1); % exporting feasible value of matrix variable from "xfeas" using "dec2mat"
R1 = dec2mat(lmis,xfeas,r1);
k = dec2mat(lmis,xfeas,k);
K = R1*Q1^-1;
K1 = [0 1]*k;
disp('K = ');disp(K);
disp('K1 = ');disp(K1);
```

（2）主程序：main.m

```

```





[1]  刘金琨. 基于LMI的控制系统设计、分析及MATLAB仿真[M]. 北京：清华大学出版社，2020.
